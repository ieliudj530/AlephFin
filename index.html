<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AlephFin Lab</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body>

<div id="wrapper">
    <div id="sidebar-wrapper">
        <div class="sidebar-heading">
            <i class="bi bi-bank2 sidebar-logo"></i>
            <div>
                <h4 class="fw-bold mb-0 text-white">AlephFin</h4>
                <small style="color:var(--accent); letter-spacing:1px; font-size:0.7rem; text-transform:uppercase;">Green Edition</small>
            </div>
        </div>
        
        <div class="list-group list-group-flush mt-4">
            <a onclick="showView('home'); toggleMenuMobile()" id="nav-home" class="list-group-item active">
                <i class="bi bi-house-door"></i> Inicio
            </a>
            
            <div class="text-uppercase small fw-bold px-3 mt-4 mb-2" style="color:#555; font-size:0.7rem;">Simuladores</div>
            
            <a onclick="showView('sim-interest'); toggleMenuMobile()" id="nav-sim-interest" class="list-group-item">
                <i class="bi bi-bezier2"></i> Interés Compuesto
            </a>
            <a onclick="showView('strategies'); toggleMenuMobile()" id="nav-strategies" class="list-group-item">
                <i class="bi bi-lightning-charge"></i> Hacks Financieros
            </a>
            <a onclick="showView('amortization'); toggleMenuMobile()" id="nav-amortization" class="list-group-item">
                <i class="bi bi-calculator"></i> Préstamos
            </a>
            <a onclick="showView('investment'); toggleMenuMobile()" id="nav-investment" class="list-group-item">
                <i class="bi bi-piggy-bank"></i> Plan de Retiro
            </a>

            <div class="text-uppercase small fw-bold px-3 mt-4 mb-2" style="color:#555; font-size:0.7rem;">Herramientas</div>
            <a onclick="showView('audit'); toggleMenuMobile()" id="nav-audit" class="list-group-item">
                <i class="bi bi-file-earmark-bar-graph"></i> Auditoría Real
            </a>

            <a href="#" class="list-group-item mt-4" data-bs-toggle="modal" data-bs-target="#manualModal">
                <i class="bi bi-journal-check" style="color:var(--accent)"></i> Manual Completo
            </a>
        </div>
    </div>

    <div id="page-content-wrapper">
        <nav class="navbar navbar-light bg-white border-bottom d-md-none mb-3 shadow-sm sticky-top">
            <div class="container-fluid">
                <button class="btn border-0" id="menu-toggle"><i class="bi bi-list" style="font-size: 1.5rem;"></i></button>
                <span class="navbar-brand mb-0 h1 fw-bold text-dark">AlephFin</span>
                <div style="width: 40px;"></div>
            </div>
        </nav>

        <div class="container-fluid p-4">
            
            <div id="view-home" class="fade-in">
                <div class="p-5 mb-4 bg-white rounded-3 shadow-sm border-top-accent text-center">
                    <h1 class="display-5 fw-bold text-dark">AlephFin Lab</h1>
                    <p class="fs-5 text-muted">Aprende a usar el interés compuesto a tu favor y no en tu contra.</p>
                    <div class="d-grid gap-3 d-sm-flex justify-content-sm-center mt-4">
                        <button class="btn btn-aleph btn-lg px-4" onclick="showView('sim-interest')">
                            <i class="bi bi-play-circle me-2"></i>Ver Efecto Bola de Nieve
                        </button>
                    </div>
                </div>
            </div>

            <div id="view-sim-interest" class="d-none">
                <h3 class="fw-bold mb-4 text-dark">Interés Simple vs Compuesto</h3>
                <div class="row g-4">
                    <div class="col-lg-4">
                        <div class="card shadow-sm border-0">
                            <div class="card-body">
                                <h6 class="fw-bold text-muted mb-3">Parámetros</h6>
                                <label class="small fw-bold text-dark">Capital Inicial ($)</label>
                                <input type="number" id="inpCapital" class="form-control mb-3" placeholder="Ej: 1000">
                                <label class="small fw-bold text-dark">Tasa Anual (%)</label>
                                <input type="number" id="inpRate" class="form-control mb-3" placeholder="Ej: 10">
                                <label class="small fw-bold text-dark">Tiempo (Años)</label>
                                <input type="number" id="inpTime" class="form-control mb-4" placeholder="Ej: 20">
                                <button class="btn btn-aleph w-100" onclick="runSim()"><i class="bi bi-play-circle me-2"></i>Calcular Gráfica</button>
                            </div>
                        </div>
                        <div class="row g-2">
                            <div class="col-6"><div class="p-3 border rounded text-center bg-white h-100"><small class="d-block text-muted text-uppercase" style="font-size:0.7rem;">Simple</small><strong class="text-secondary fs-5" id="valSimple">$0</strong></div></div>
                            <div class="col-6"><div class="p-3 border rounded text-center bg-white h-100 border-start-accent"><small class="d-block text-success text-uppercase fw-bold" style="font-size:0.7rem;">Compuesto</small><strong class="text-dark fs-5" id="valCompound">$0</strong></div></div>
                        </div>
                    </div>
                    <div class="col-lg-8"><div class="card shadow-sm h-100"><div class="card-body"><div class="chart-container"><canvas id="simChart"></canvas></div></div></div></div>
                </div>
            </div>

            <div id="view-strategies" class="d-none">
                <h3 class="fw-bold mb-4 text-dark">Estrategias Avanzadas</h3>
                <ul class="nav nav-pills mb-4" id="pills-tab" role="tablist">
                    <li class="nav-item"><button class="nav-link active" id="pills-leverage-tab" data-bs-toggle="pill" data-bs-target="#pills-leverage">Apalancamiento</button></li>
                    <li class="nav-item"><button class="nav-link" id="pills-cc-tab" data-bs-toggle="pill" data-bs-target="#pills-cc">Jinete Libre (TC)</button></li>
                </ul>
                <div class="tab-content">
                    <div class="tab-pane fade show active" id="pills-leverage">
                        <div class="row g-4">
                            <div class="col-lg-4"><div class="card shadow-sm border-top-accent"><div class="card-body"><label class="small text-muted fw-bold">Monto</label><input type="number" id="levAmount" class="form-control mb-2" placeholder="0"><label class="small text-muted fw-bold">Tasa Préstamo (%)</label><input type="number" id="levCost" class="form-control mb-2" placeholder="0"><label class="small text-muted fw-bold">ROI Negocio (%)</label><input type="number" id="levRoi" class="form-control mb-3" placeholder="0"><button class="btn btn-aleph w-100" onclick="calcLeverage()">Analizar</button></div></div></div>
                            <div class="col-lg-8"><div class="card shadow-sm h-100"><div class="card-body text-center"><h5 class="text-muted">Resultado Neto</h5><h1 class="display-4 fw-bold" id="levResult">$0</h1><div id="levMessage" class="badge bg-light text-dark fs-6 mt-2">Ingresa datos</div><div class="mt-4" style="height: 200px;"><canvas id="levChart"></canvas></div></div></div></div>
                        </div>
                    </div>
                    <div class="tab-pane fade" id="pills-cc">
                        <div class="row g-4">
                            <div class="col-lg-4"><div class="card shadow-sm border-start-blue"><div class="card-body"><label class="small text-muted fw-bold">Gasto Mensual TC</label><input type="number" id="ccSpend" class="form-control mb-2" placeholder="0"><label class="small text-muted fw-bold">Tasa Inversión (%)</label><input type="number" id="ccRate" class="form-control mb-3" placeholder="0"><button class="btn btn-dark w-100" onclick="calcCreditCard()">Calcular</button></div></div></div>
                            <div class="col-lg-8"><div class="card shadow-sm h-100 bg-light border-dashed"><div class="card-body text-center d-flex flex-column justify-content-center"><h3 class="text-muted">Ganancia Anual</h3><h1 class="display-3 fw-bold text-success" id="ccResult">$0</h1><p class="text-muted small">Dinero gratis por usar tarjeta y pagar totalero.</p></div></div></div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="view-amortization" class="d-none">
                <div class="d-flex justify-content-between align-items-center mb-4"><h3 class="fw-bold text-dark">Simulador Préstamos</h3><div class="btn-group shadow-sm" role="group"><input type="radio" class="btn-check" name="sysType" id="sysPrice" value="price" checked onchange="calcAmortization()"><label class="btn btn-outline-secondary btn-sm" for="sysPrice">Francés</label><input type="radio" class="btn-check" name="sysType" id="sysSac" value="sac" onchange="calcAmortization()"><label class="btn btn-outline-secondary btn-sm" for="sysSac">Alemán</label></div></div>
                <div class="row g-4">
                    <div class="col-lg-3"><div class="card shadow-sm border-top-accent"><div class="card-body"><label class="small fw-bold text-muted">Monto</label><input type="number" id="amoAmount" class="form-control mb-2" placeholder="0"><label class="small fw-bold text-muted">Tasa Anual (%)</label><input type="number" id="amoRate" class="form-control mb-2" placeholder="0" step="0.1"><label class="small fw-bold text-muted">Plazo (Meses)</label><input type="number" id="amoMonths" class="form-control mb-3" placeholder="0"><div class="bg-light p-2 rounded mb-3 border border-success"><label class="small fw-bold text-success mb-1">Abono Extra</label><input type="number" id="amoExtra" class="form-control border-success" placeholder="0"></div><button class="btn btn-dark w-100 btn-sm" onclick="calcAmortization()">Calcular</button><div class="mt-3 text-center border-top pt-2"><small class="text-muted d-block">1ª Cuota</small><h4 class="fw-bold text-dark mb-0" id="valQuota">$0</h4></div></div></div></div>
                    <div class="col-lg-9">
                        <div id="savingsAlert" class="alert alert-success d-none mb-3 shadow-sm border-0 d-flex align-items-center"><i class="bi bi-trophy-fill fs-3 me-3"></i><div><h6 class="fw-bold mb-0">¡Ahorro Confirmado!</h6><p class="mb-0 small">Ahorraste <strong id="saveInterest">$0</strong> y terminaste <strong id="saveTime">0</strong> meses antes.</p></div></div>
                        <ul class="nav nav-tabs mb-3"><li class="nav-item"><button class="nav-link active text-dark" id="chart-tab" data-bs-toggle="tab" data-bs-target="#tabChart">Gráfico</button></li><li class="nav-item"><button class="nav-link text-dark" id="table-tab" data-bs-toggle="tab" data-bs-target="#tabTable">Tabla</button></li></ul>
                        <div class="tab-content">
                            <div class="tab-pane fade show active" id="tabChart"><div class="card shadow-sm"><div class="card-body"><div class="chart-container"><canvas id="amortizationChart"></canvas></div></div></div></div>
                            <div class="tab-pane fade" id="tabTable"><div class="card shadow-sm border-0"><div class="card-body p-0"><div class="table-responsive" style="max-height: 400px;"><table class="table table-striped table-hover small mb-0 text-end" id="amortizationTable"><thead class="table-dark text-white sticky-top"><tr><th class="text-center">Mes</th><th>Cuota</th><th>Interés</th><th>Capital</th><th>Saldo</th></tr></thead><tbody></tbody></table></div></div></div></div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="view-investment" class="d-none">
                <h3 class="fw-bold mb-4 text-dark">Plan de Retiro</h3>
                <div class="row g-4">
                    <div class="col-lg-3"><div class="card shadow-sm border-top-accent"><div class="card-body"><label class="small fw-bold text-muted">Inicial</label><input type="number" id="invInitial" class="form-control mb-2" placeholder="0"><label class="small fw-bold text-muted">Mensual</label><input type="number" id="invMonthly" class="form-control mb-2" placeholder="0"><label class="small fw-bold text-muted">Tasa Anual (%)</label><input type="number" id="invRate" class="form-control mb-2" placeholder="0"><label class="small fw-bold text-muted">Años</label><input type="number" id="invYears" class="form-control mb-3" placeholder="0"><button class="btn btn-aleph w-100" onclick="calcInvestment()">Proyectar</button></div></div></div>
                    <div class="col-lg-9"><div class="card shadow-sm h-100"><div class="card-body"><div class="chart-container"><canvas id="invChart"></canvas></div><div class="row mt-4 text-center"><div class="col-6 border-end"><small class="text-muted fw-bold">TU ESFUERZO</small><h4 class="text-dark fw-bold" id="valTotalContrib">$0</h4></div><div class="col-6"><small class="text-success fw-bold">REGALO INTERÉS</small><h4 class="text-success fw-bold" id="valTotalInterest">$0</h4></div></div></div></div></div>
                </div>
            </div>

            <div id="view-audit" class="d-none">
                <div class="d-flex justify-content-between align-items-center mb-4"><h3 class="fw-bold text-dark">Auditoría Real</h3><button class="btn btn-sm btn-outline-secondary" onclick="downloadTemplate()">Plantilla CSV</button></div>
                <div class="card p-5 text-center shadow-sm mb-4 border-dashed" id="upload-area"><div class="card-body"><h5 class="mt-3">Sube tu Historial</h5><input type="file" id="fileInput" accept=".csv, .xlsx" class="d-none"><button class="btn btn-aleph mt-2" onclick="document.getElementById('fileInput').click()">Seleccionar Excel</button></div></div>
                <div id="results-area" class="d-none">
                    <div class="row g-4 mb-4"><div class="col-md-4"><div class="card h-100 border-start-accent"><div class="card-body"><small class="text-muted fw-bold">MWR</small><h2 class="fw-bold mt-2" id="val-mwr">0%</h2></div></div></div><div class="col-md-4"><div class="card h-100 border-start-blue"><div class="card-body"><small class="text-muted fw-bold">TWR</small><h2 class="fw-bold mt-2" id="val-twr">0%</h2></div></div></div><div class="col-md-4"><div class="card h-100"><div class="card-body"><small class="text-muted fw-bold">Ganancia</small><h2 class="fw-bold mt-2" id="val-profit">$0</h2></div></div></div></div>
                    <div class="card shadow-sm"><div class="card-body"><div class="chart-container"><canvas id="auditChart"></canvas></div></div></div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="manualModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header bg-dark text-white"><h5 class="modal-title"><i class="bi bi-book me-2"></i>Manual Completo AlephFin</h5><button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button></div>
      <div class="modal-body p-4 text-secondary">
        
        <h5 class="text-dark fw-bold mb-3"><i class="bi bi-bezier2 me-2 text-success"></i>1. Interés Compuesto</h5>
        <p>Entiende la diferencia entre crecimiento lineal y exponencial.</p>
        <ul>
            <li>Ingresa capital, tasa y tiempo. Pulsa <strong>Calcular Gráfica</strong>.</li>
            <li>La diferencia entre la línea gris (simple) y la verde (compuesto) es el dinero que ganas por reinvertir.</li>
        </ul>
        <hr>

        <h5 class="text-dark fw-bold mb-3"><i class="bi bi-lightning-charge me-2 text-success"></i>2. Hacks Financieros</h5>
        <p>Estrategias para usar el dinero del banco a tu favor:</p>
        <ul>
            <li><strong>Apalancamiento:</strong> Si el ROI de tu negocio es mayor que la Tasa del Préstamo, la deuda es "Buena". La barra verde te muestra tu ganancia neta después de pagar intereses.</li>
            <li><strong>Jinete Libre (TC):</strong> Calcula cuánto dinero "gratis" obtienes al usar tu tarjeta de crédito, invertir ese dinero por 45 días y pagar el total antes del vencimiento.</li>
        </ul>
        <hr>

        <h5 class="text-dark fw-bold mb-3"><i class="bi bi-shield-lock me-2 text-success"></i>3. Hackear Préstamo (Amortización)</h5>
        <p>Descubre cuánto pagas realmente y cómo ahorrar.</p>
        <ul>
            <li><strong>Sistemas:</strong> Elige Francés (cuota fija) o Alemán (amortización fija).</li>
            <li><strong>Estrategia Francotirador:</strong> Usa la casilla <em>Abono Extra</em>. Pagar directo a capital reduce el plazo y los intereses drásticamente.</li>
        </ul>
        <hr>

        <h5 class="text-dark fw-bold mb-3"><i class="bi bi-file-earmark-bar-graph me-2 text-success"></i>4. Auditoría Real</h5>
        <p>Para usuarios avanzados que quieren auditar su portafolio.</p>
        <ul>
            <li>Sube un Excel con columnas: Fecha, Flujo (+/-), Saldo.</li>
            <li><strong>MWR:</strong> Tu tasa interna real.</li>
            <li><strong>TWR:</strong> Rendimiento puro de la estrategia.</li>
        </ul>

      </div>
      <div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button></div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="main.js"></script>
</body>
</html>